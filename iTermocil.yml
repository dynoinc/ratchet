windows:
  - name: ratchet
    root: ~/src/ratchet
    layout: main-vertical-flipped
    panes:
      - docker compose up --remove-orphans --watch --attach app --build
      - fswatch go.sum internal/ cmd/ | GOOS=linux xargs -n1 -I{} go build -o bin/ratchet ./cmd/ratchet/main.go
      - fswatch internal/storage/sqlc.yml internal/storage/query.sql internal/storage/schema/migrations/ | xargs -n1 -I{} sqlc generate -f internal/storage/sqlc.yml
      - /bin/bash
